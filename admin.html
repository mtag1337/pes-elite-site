<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PES ELITE | Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root { --main: #eaff00; --bg: #050507; --card: #111116; --danger: #ff3e3e; --success: #00ff88; }
        * { box-sizing: border-box; outline: none; }
        body { background: var(--bg); color: white; font-family: 'Cairo', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Sidebar */
        .sidebar { width: 300px; background: var(--card); border-left: 1px solid #222; padding: 20px; display: flex; flex-direction: column; overflow-y: auto; }
        .sidebar h2 { color: var(--main); text-align: center; font-weight: 900; margin-bottom: 20px; }
        .nav-btn { padding: 12px 15px; margin: 4px 0; border-radius: 10px; cursor: pointer; border: none; background: none; color: #aaa; text-align: right; font-size: 14px; transition: 0.3s; width: 100%; font-family: 'Cairo'; }
        .nav-btn i { margin-left: 10px; width: 20px; text-align: center; }
        .nav-btn:hover, .nav-btn.active { background: var(--main); color: #000; font-weight: bold; }

        /* Workspace */
        .workspace { flex: 1; padding: 25px; overflow-y: auto; background: #08080c; }
        .section { display: none; }
        .active-sec { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* General UI Elements */
        .card { background: var(--card); border: 1px solid #222; border-radius: 15px; padding: 20px; margin-bottom: 20px; }
        .grid-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; }
        .stat-box { background: #1a1a22; padding: 20px; border-radius: 15px; text-align: center; border-bottom: 4px solid var(--main); }
        
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; background: #000; border: 1px solid #333; color: #fff; border-radius: 8px; font-family: 'Cairo'; }
        .btn-action { background: var(--main); color: #000; border: none; padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 13px; }
        th { background: #1a1a1a; color: var(--main); padding: 12px; border: 1px solid #222; }
        td { padding: 10px; border: 1px solid #222; text-align: center; }
        .squad-img { width: 40px; height: 40px; object-fit: cover; border-radius: 5px; }
    </style>
</head>
<body>

<aside class="sidebar">
    <h2>PES ELITE ADM</h2>
    <button class="nav-btn active" onclick="openSec('statSec', this)"><i class="fas fa-chart-bar"></i> Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</button>
    <button class="nav-btn" onclick="openSec('tourSec', this)"><i class="fas fa-trophy"></i> Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª (Ù‚Ø±Ø¹Ø©)</button>
    <button class="nav-btn" onclick="openSec('leagueSec', this)"><i class="fas fa-list-ol"></i> Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙˆØ±ÙŠ (15 ÙØ±ÙŠÙ‚)</button>
    <button class="nav-btn" onclick="openSec('playerMgrSec', this)"><i class="fas fa-users-cog"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ø¨Ø­Ø«</button>
    <button class="nav-btn" onclick="openSec('chatControlSec', this)"><i class="fas fa-user-shield"></i> Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„Ø´Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©</button>
    <button class="nav-btn" onclick="openSec('newsSec', this)"><i class="fas fa-scroll"></i> Ø§Ù„Ù„ÙˆØ§Ø¦Ø­ ÙˆØ§Ù„Ø£Ø®Ø¨Ø§Ø±</button>
    <button class="nav-btn" onclick="openSec('marketSec', this)"><i class="fas fa-handshake"></i> Ø³ÙˆÙ‚ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„Ø§Øª (Ø¥Ø¶Ø§ÙÙŠ)</button>
    <button class="btn-action" onclick="logout()" style="margin-top:20px; background:var(--danger); color:white;">Ø®Ø±ÙˆØ¬</button>
</aside>

<main class="workspace">
    <div id="statSec" class="section active-sec">
        <div class="grid-stats">
            <div class="stat-box"><h3>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h3><p id="totalUsers">0</p></div>
            <div class="stat-box"><h3>Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠ</h3><p>450</p></div>
            <div class="stat-box"><h3>Ù†Ø´Ø§Ø· Ø§Ù„Ø´Ø§Øª</h3><p id="chatActivity">Ø¹Ø§Ù„ÙŠ</p></div>
            <div class="stat-box"><h3>Ø¬ÙˆØ§Ø¦Ø² Ù…ÙˆØ²Ø¹Ø©</h3><p>150K GP</p></div>
        </div>
        
    </div>

    <div id="tourSec" class="section">
        <div class="card">
            <h3>Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·ÙˆÙ„Ø© Ø¨Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø±Ø¹Ø©</h3>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                <input type="text" id="tourName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©">
                <select id="tourType">
                    <option value="knockout">Ø®Ø±ÙˆØ¬ Ù…ØºÙ„ÙˆØ¨ (Ø¬ÙˆÙ„Ø© ÙˆØ§Ø­Ø¯Ø©)</option>
                    <option value="home_away">Ø°Ù‡Ø§Ø¨ ÙˆØ¥ÙŠØ§Ø¨ (Ø¨Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù)</option>
                </select>
                <input type="number" id="tourMax" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†">
                <button class="btn-action" onclick="generateDraw()">Ø¹Ù…Ù„ Ù‚Ø±Ø¹Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ğŸ²</button>
            </div>
        </div>
        <div id="tourMatchesDraw"></div>
    </div>

    <div id="leagueSec" class="section">
        <div class="card">
            <h3>Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¹Ø§Ù… (15 Ù„Ø§Ø¹Ø¨)</h3>
            <button class="btn-action" onclick="showPlayerPicker()">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù€ 15 Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†</button>
        </div>
        <div class="card" style="overflow-x:auto;">
            <h3>Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø­ÙŠ</h3>
            <table id="leagueStandings">
                <thead>
                    <tr><th>Ø§Ù„Ù…Ø±ÙƒØ²</th><th>Ø§Ù„Ù„Ø§Ø¹Ø¨</th><th>Ù„Ø¹Ø¨</th><th>ÙÙˆØ²</th><th>ØªØ¹Ø§Ø¯Ù„</th><th>Ø®Ø³Ø§Ø±Ø©</th><th>Ù„Ù‡</th><th>Ø¹Ù„ÙŠÙ‡</th><th>Ù†Ù‚Ø§Ø·</th><th>Ø§Ù„ØªØ´ÙƒÙŠÙ„Ø©</th></tr>
                </thead>
                <tbody id="leagueBody"></tbody>
            </table>
        </div>
    </div>

    <div id="playerMgrSec" class="section">
        <div class="card">
            <h3>Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ø¹Ù† Ù„Ø§Ø¹Ø¨</h3>
            <div style="display:flex; gap:10px;">
                <input type="text" id="searchInp" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø£Ùˆ Ø§Ù„Ù€ ID...">
                <button class="btn-action" onclick="searchPlayer()">Ø¨Ø­Ø«</button>
            </div>
        </div>
        <div id="searchResult"></div>
    </div>

    <div id="chatControlSec" class="section">
        <div class="card">
            <h3>ØºØ±ÙØ© Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø´Ø§Øª</h3>
            <div id="chatStream" style="height:300px; overflow-y:auto; background:#000; padding:10px; border-radius:10px;"></div>
            <div style="margin-top:10px; display:flex; gap:10px;">
                <button class="btn-action" style="background:orange" onclick="muteAll()">ÙƒØªÙ… Ø§Ù„Ø¬Ù…ÙŠØ¹</button>
                <button class="btn-action" style="background:var(--danger); color:#white" onclick="clearAllMessages()">Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>
            </div>
        </div>
    </div>
</main>

<script>
    // --- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù€ Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ ---
    const firebaseConfig = {
        apiKey: "AIzaSyCYAtj7gB7bfXPPSRojddCzhIyUMN7Tnow",
        projectId: "pes-elite",
        authDomain: "pes-elite.firebaseapp.com",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ†Ù‚Ù„ ---
    function openSec(id, btn) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active-sec'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active-sec');
        btn.classList.add('active');
    }

    // --- Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… (15 ÙØ±ÙŠÙ‚) ---
    // Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© ØªØ­Ø³Ø¨ Ø§Ù„ØªØ±ØªÙŠØ¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
    function updateLeagueTable() {
        // Ø³ÙŠØªÙ… Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù€ 15 Ù„Ø§Ø¹Ø¨ ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ù† Firestore
        const players = []; // Ù…ØµÙÙˆÙØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
        const tbody = document.getElementById('leagueBody');
        tbody.innerHTML = "";
        
        // Ù…Ø«Ø§Ù„ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§Ø¹Ø¨ ÙˆØ§Ø­Ø¯ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        for(let i=1; i<=15; i++) {
            tbody.innerHTML += `
            <tr>
                <td>${i}</td>
                <td>Ù„Ø§Ø¹Ø¨ ${i}</td>
                <td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                <td style="font-weight:900; color:var(--main)">0</td>
                <td><img src="squad_placeholder.jpg" class="squad-img" onclick="viewFullSquad()"></td>
            </tr>`;
        }
    }

    // --- Ù…Ø­Ø±Ùƒ Ø§Ù„Ù‚Ø±Ø¹Ø© Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ---
    async function generateDraw() {
        const type = document.getElementById('tourType').value;
        const name = document.getElementById('tourName').value;
        // Ù…Ù†Ø·Ù‚ Ø§Ù„Ù‚Ø±Ø¹Ø©: Ø¬Ù„Ø¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙˆØ¹Ù…Ù„ Shuffle (Ø®Ù„Ø· Ø¹Ø´ÙˆØ§Ø¦ÙŠ)
        alert(`ØªÙ… Ø¨Ø¯Ø¡ Ù‚Ø±Ø¹Ø© Ø¨Ø·ÙˆÙ„Ø© ${name} Ø¨Ù†Ø¸Ø§Ù… ${type}`);
    }

    // --- ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù… ---
    async function searchPlayer() {
        const val = document.getElementById('searchInp').value;
        const resDiv = document.getElementById('searchResult');
        // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firestore
        resDiv.innerHTML = `
            <div class="card">
                <h3>Ù…Ù„Ù Ø§Ù„Ù„Ø§Ø¹Ø¨: ${val}</h3>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                    <div>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø·: 1500 GP</p>
                        <p>Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª: 3</p>
                        <button class="btn-action" style="background:red; color:white">Ø­Ø¸Ø± Ø§Ù„Ø­Ø³Ø§Ø¨</button>
                    </div>
                    <img src="squad_example.jpg" style="width:100%; border:2px solid var(--main); border-radius:10px;">
                </div>
            </div>`;
    }

    // --- Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Øª ---
    function muteAll() {
        db.collection("settings").doc("chat").update({ status: "muted" });
        alert("ØªÙ… ÙƒØªÙ… Ø§Ù„Ø´Ø§Øª Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†");
    }

    // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ§Ø¨Ø¹ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    updateLeagueTable();
</script>
</body>
</html>
