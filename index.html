<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PES ELITE | PRO ADMIN SYSTEM</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --ef-blue: #0014d3; --ef-yellow: #eaff00; --ef-pink: #ff007a;
            --dark-bg: #050508; --card-bg: #111118;
        }
        body { margin: 0; font-family: 'Cairo', sans-serif; background: var(--dark-bg); color: white; display: flex; }
        
        /* Sidebar */
        .sidebar { width: 280px; background: #000; border-left: 1px solid #222; height: 100vh; position: fixed; padding: 20px; }
        .sidebar-header { font-family: 'Orbitron'; font-size: 22px; color: var(--ef-yellow); border-bottom: 2px solid var(--ef-pink); padding-bottom: 15px; margin-bottom: 20px; text-align: center; }
        
        .nav-link { 
            width: 100%; padding: 15px; margin-bottom: 8px; border-radius: 10px; border: none; 
            background: none; color: #888; text-align: right; cursor: pointer; transition: 0.3s;
            display: flex; align-items: center; gap: 12px; font-weight: bold;
        }
        .nav-link:hover, .nav-link.active { background: var(--ef-blue); color: white; box-shadow: 0 5px 15px rgba(0,20,211,0.4); }

        /* Main Content */
        .content { margin-right: 280px; flex: 1; padding: 40px; }
        .admin-section { display: none; animation: slideUp 0.4s ease; }
        .admin-section.active { display: block; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Cards & UI */
        .glass-card { background: var(--card-bg); padding: 25px; border-radius: 20px; border: 1px solid #222; margin-bottom: 25px; }
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
        .stat-box { background: var(--card-bg); padding: 20px; border-radius: 15px; border-bottom: 4px solid var(--ef-blue); text-align: center; }
        .stat-box h3 { font-size: 14px; color: #666; margin: 0; }
        .stat-box p { font-size: 28px; font-family: 'Orbitron'; margin: 10px 0 0; color: var(--ef-yellow); }

        /* Forms */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; color: #aaa; font-size: 14px; }
        input, select { width: 100%; padding: 12px; background: #1a1a25; border: 1px solid #333; color: white; border-radius: 8px; outline: none; }
        input:focus { border-color: var(--ef-blue); }
        .btn-action { width: 100%; padding: 15px; background: var(--ef-pink); border: none; color: white; font-weight: 900; border-radius: 8px; cursor: pointer; margin-top: 10px; }
        .btn-action:hover { filter: brightness(1.2); }

        /* Tables */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #000; border-radius: 10px; overflow: hidden; }
        th { background: #1a1a25; padding: 15px; color: var(--ef-yellow); text-align: center; }
        td { padding: 15px; text-align: center; border-bottom: 1px solid #111; }
        .badge-verified { background: #00ff88; color: black; padding: 4px 8px; border-radius: 5px; font-size: 12px; font-weight: bold; }
        .btn-delete { color: #ff4d4d; cursor: pointer; background: none; border: none; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-header">PES ELITE HUB</div>
        <button class="nav-link active" onclick="openTab('overview')"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <button class="nav-link" onclick="openTab('tournaments')"><i class="fas fa-trophy"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª</button>
        <button class="nav-link" onclick="openTab('players')"><i class="fas fa-user-plus"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</button>
        <button class="nav-link" onclick="openTab('results')"><i class="fas fa-file-invoice"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
        <button class="nav-link" onclick="openTab('news')"><i class="fas fa-rss"></i> Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ø³ÙŠØ³ØªÙ…</button>
        <button class="nav-link" style="color:var(--ef-pink); margin-top:100px;" onclick="auth.signOut()"><i class="fas fa-power-off"></i> Ø®Ø±ÙˆØ¬</button>
    </div>

    <div class="content">
        <div id="overview" class="admin-section active">
            <h1 style="font-family:'Orbitron'">DASHBOARD OVERVIEW</h1>
            <div class="stats-grid">
                <div class="stat-box"><h3>Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª</h3><p id="stat-tours">0</p></div>
                <div class="stat-box"><h3>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h3><p id="stat-players">0</p></div>
                <div class="stat-box"><h3>Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</h3><p id="stat-matches">0</p></div>
                <div class="stat-box"><h3>Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²</h3><p id="stat-awards">120K</p></div>
            </div>
            <div class="glass-card">
                <h2>Ø¢Ø®Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ù†Ø¶Ù…ÙŠÙ†</h2>
                <table id="playersTable">
                    <thead><tr><th>Ø§Ù„Ù„Ø§Ø¹Ø¨</th><th>Ø§Ù„Ø­Ø³Ø§Ø¨</th><th>ID</th><th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead>
                    <tbody id="pList"></tbody>
                </table>
            </div>
        </div>

        <div id="news" class="admin-section">
            <div class="glass-card">
                <h2><i class="fas fa-rss"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©</h2>
                <input type="text" id="globalNews" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø®Ø¨Ø± Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†...">
                <button class="btn-action" onclick="saveNews()">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>

        <div id="results" class="admin-section">
            <div class="glass-card">
                <h2><i class="fas fa-futbol"></i> ØªØ³Ø¬ÙŠÙ„ Ù†ØªÙŠØ¬Ø© Ù…Ø¨Ø§Ø±Ø§Ø© Ø±Ø³Ù…ÙŠØ©</h2>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
                    <div class="form-group"><label>Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„</label><input type="text" id="resP1"></div>
                    <div class="form-group"><label>Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ</label><input type="text" id="resP2"></div>
                    <div class="form-group"><label>Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø£ÙˆÙ„</label><input type="number" id="resS1"></div>
                    <div class="form-group"><label>Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø«Ø§Ù†ÙŠ</label><input type="number" id="resS2"></div>
                </div>
                <button class="btn-action" style="background:var(--ef-blue)" onclick="saveMatch()">Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
            </div>
        </div>

        <div id="players" class="admin-section">
            <div class="glass-card">
                <h2><i class="fas fa-user-edit"></i> Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ù„Ø§Ø¹Ø¨</h2>
                <div class="form-group"><label>Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ (Nickname)</label><input type="text" id="addName"></div>
                <div class="form-group"><label>E-Football ID</label><input type="text" id="addID"></div>
                <button class="btn-action" onclick="addPlayer()">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù†Ø¸Ø§Ù…</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase Config (Keep yours)
        const firebaseConfig = {
            apiKey: "AIzaSyCYAtj7gB7bfXPPSRojddCzhIyUMN7Tnow",
            authDomain: "pes-elite.firebaseapp.com",
            projectId: "pes-elite",
            storageBucket: "pes-elite.firebasestorage.app",
            messagingSenderId: "407069539120",
            appId: "1:407069539120:web:466249fa7f716266d9e6f5"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(), auth = firebase.auth();

        // ğŸ›¡ï¸ Admin Protection
        auth.onAuthStateChanged(user => {
            if(!user || user.email !== "mtag1337@gmail.com") window.location.href="login.html";
            else loadStats();
        });

        // ğŸ”„ Navigation
        function openTab(id) {
            document.querySelectorAll('.admin-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // ğŸ“Š Real-time Stats
        function loadStats() {
            db.collection("players").onSnapshot(s => {
                document.getElementById('stat-players').innerText = s.size;
                let html = "";
                s.forEach(doc => {
                    const p = doc.data();
                    html += `<tr>
                        <td>${p.nickname} ${p.verified?'<span class="badge-verified">V</span>':''}</td>
                        <td>${p.email}</td>
                        <td>${p.efootballId}</td>
                        <td><button class="btn-delete" onclick="deleteUser('${doc.id}')"><i class="fas fa-trash"></i></button></td>
                    </tr>`;
                });
                document.getElementById('pList').innerHTML = html;
            });
            db.collection("leagueMatches").onSnapshot(s => document.getElementById('stat-matches').innerText = s.size);
        }

        // ğŸ“ Functions
        async function saveNews() {
            const news = document.getElementById('globalNews').value;
            await db.collection("settings").doc("leagueConfig").set({ news: news }, { merge: true });
            alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„!");
        }

        async function saveMatch() {
            const match = {
                player1: document.getElementById('resP1').value,
                player2: document.getElementById('resP2').value,
                score1: document.getElementById('resS1').value,
                score2: document.getElementById('resS2').value,
                time: firebase.firestore.FieldValue.serverTimestamp()
            };
            await db.collection("leagueMatches").add(match);
            alert("ØªÙ… Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¯ÙˆØ±ÙŠ ÙÙˆØ±Ø§Ù‹!");
        }

        async function deleteUser(id) {
            if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù„Ø§Ø¹Ø¨ØŸ")) await db.collection("players").doc(id).delete();
        }

        async function addPlayer() {
            const name = document.getElementById('addName').value;
            const id = document.getElementById('addID').value;
            await db.collection("players").add({
                nickname: name, efootballId: id, verified: true, joinedAt: new Date()
            });
            alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø¨Ù†Ø¬Ø§Ø­!");
        }
    </script>
</body>
</html>
