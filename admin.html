<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>PES ELITE | Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
    <style>
        body { background: #050508; color: white; font-family: 'Cairo'; display: flex; justify-content: center; padding: 20px; }
        .card { background: #12121a; padding: 20px; border-radius: 15px; border: 1px solid #eaff00; width: 100%; max-width: 500px; text-align: center; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; background: #000; color: #fff; border: 1px solid #333; }
        .btn { width: 100%; padding: 15px; background: #eaff00; color: #000; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        #admin-panel { display: none; width: 100%; max-width: 800px; }
    </style>
</head>
<body>
    <div id="auth-gate" class="card">
        <h2>ğŸ”’ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¯Ù…Ù†</h2>
        <button class="btn" onclick="login()">Ø¯Ø®ÙˆÙ„ Ø¬ÙˆØ¬Ù„</button>
        <div id="pass-section" style="display:none; margin-top:15px;">
            <input type="password" id="sk" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button class="btn" onclick="checkSk()">ÙØªØ­ Ø§Ù„Ù„ÙˆØ­Ø©</button>
        </div>
    </div>

    <div id="admin-panel">
        <div class="card" style="max-width:none">
            <h2>âš½ ØªØ³Ø¬ÙŠÙ„ Ù†ØªÙŠØ¬Ø©</h2>
            <select id="t1"></select><select id="t2"></select>
            <input type="number" id="s1" placeholder="Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø£ÙˆÙ„"><input type="number" id="s2" placeholder="Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø«Ø§Ù†ÙŠ">
            <button class="btn" onclick="addMatch()">Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© âœ…</button>
        </div>
        <div class="card" style="max-width:none; margin-top:20px;">
            <h2>ğŸ“ ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù…</h2>
            <select id="editList"></select>
            <input type="text" id="newName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯">
            <button class="btn" style="background:#fff" onclick="rename()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù… ğŸ”„</button>
        </div>
        <button class="btn" style="background:red; color:white; margin-top:20px;" onclick="resetAll()">ğŸš¨ ØªØµÙÙŠØ± Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>
    </div>

<script>
    const config = { apiKey: "AIzaSyCYAtj7gB7bfXPPSRojddCzhIyUMN7Tnow", authDomain: "pes-elite.firebaseapp.com", projectId: "pes-elite", storageBucket: "pes-elite.firebasestorage.app", messagingSenderId: "407069539120", appId: "1:407069539120:web:466249fa7f716266d9e6f5" };
    firebase.initializeApp(config);
    const db = firebase.firestore(); const auth = firebase.auth();

    function login() { auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()); }
    function checkSk() { if(document.getElementById('sk').value === "123456") { document.getElementById('auth-gate').style.display='none'; document.getElementById('admin-panel').style.display='block'; load(); } }
    auth.onAuthStateChanged(u => { if(u && u.email === "mtag1337@gmail.com") document.getElementById('pass-section').style.display='block'; });

    function load() {
        db.collection("MainLeague").orderBy("id").onSnapshot(s => {
            let h = '<option value="">Ø§Ø®ØªØ±..</option>'; s.forEach(d => h+=`<option value="${d.id}">${d.data().name}</option>`);
            document.getElementById('t1').innerHTML=h; document.getElementById('t2').innerHTML=h; document.getElementById('editList').innerHTML=h;
        });
    }

    async function addMatch() {
        const i1=document.getElementById('t1').value, i2=document.getElementById('t2').value, g1=parseInt(document.getElementById('s1').value), g2=parseInt(document.getElementById('s2').value);
        if(!i1 || !i2) return alert("Ø§Ø®ØªØ± Ø§Ù„ÙØ±Ù‚!");
        await db.collection("AllMatches").add({t1:i1, t2:i2, s1:g1, s2:g2, time:Date.now()});
        await up(i1, g1, g2); await up(i2, g2, g1); alert("ØªÙ… Ø§Ù„Ø­ÙØ¸!");
    }

    async function up(id, gf, ga) {
        const r=db.collection("MainLeague").doc(id), d=(await r.get()).data();
        let w=gf>ga?1:0, dr=gf===ga?1:0;
        await r.update({ played:(d.played||0)+1, pts:(d.pts||0)+(w*3+dr), gd:(d.gd||0)+(gf-ga) });
    }

    async function rename() { await db.collection("MainLeague").doc(document.getElementById('editList').value).update({name:document.getElementById('newName').value}); alert("ØªÙ…!"); }

    async function resetAll() {
        if(!confirm("Ù…Ø³Ø­ ÙƒÙ„ Ø´ÙŠØ¡ØŸ")) return;
        for(let i=1; i<=15; i++) await db.collection("MainLeague").doc("team"+i).set({id:i, name:"ÙØ±ÙŠÙ‚ "+i, played:0, pts:0, gd:0});
        alert("ØªÙ… Ø§Ù„ØªØµÙÙŠØ±!");
    }
</script>
</body>
</html>
